<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Счётчик напитков</title>
    <style>
        @font-face {
            font-family: 'Junegull';
            src: url('Junegull.ttf') format('truetype');
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100vw;
            font-family: 'Junegull', sans-serif;
            background-color: #F4A6D7;
            overflow: hidden;
            transition: all 0.5s ease;
        }
        h1 {
            font-size: 30vw;
            color: #0047BB;
            -webkit-text-stroke: 4px white;
            transition: all 0.5s ease;
        }
        button#clickButton {
            font-size: 2rem;
            padding: 15px 30px;
            border: none;
            background-color: #0047BB;
            color: white;
            border-radius: 30px;
            max-width: 90%;
            font-family: 'Junegull', sans-serif;
            transition: all 0.5s ease;
        }
        button#clickButton:disabled { background-color: #666; cursor: not-allowed; }
        p { font-size: 1.5rem; color: #0047BB; font-family: 'Junegull', sans-serif; }
        #editButton {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1rem;
            padding: 10px;
            background-color: transparent;
            color: #0047BB;
            border: none;
            opacity: 0.5;
            font-family: 'Junegull', sans-serif;
        }
        #editButton:hover { opacity: 1; }
        .hidden { opacity: 0; height: 0; margin: 0; pointer-events: none; }
        .expanded { font-size: 40vw; width: 100%; height: 100vh; display: flex; align-items: center; justify-content: center; }
        .full-button { width: 80%; height: 60%; font-size: 4rem; }
    </style>
</head>
<body>
    <h1 id="counter">500</h1>
    <button id="clickButton" onclick="decreaseCounter()">Забрать напиток</button>
    <p id="message"></p>
    <button id="editButton" onclick="toggleMode()">ED</button>

    <!-- Подключаем Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

    <script>
        // Инициализация Firebase (замените на свои данные)
        const firebaseConfig = {
         apiKey: "AIzaSyABGFrmc4SRwuuQIkdEWhydg-ru19O0ROk",
         authDomain: "tomi-348c8.firebaseapp.com",
         databaseURL: "https://tomi-348c8-default-rtdb.europe-west1.firebasedatabase.app",
         projectId: "tomi-348c8",
         storageBucket: "tomi-348c8.firebasestorage.app",
         messagingSenderId: "805956552785",
         appId: "1:805956552785:web:11e9369f282abb25081070",
         measurementId: "G-6F31PYWZ4H"
         };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const counterRef = db.ref('counter');

        let count = 500;
        let isEditMode = false;
        const counterEl = document.getElementById('counter');
        const buttonEl = document.getElementById('clickButton');
        const messageEl = document.getElementById('message');

        // Синхронизация с Firebase
        counterRef.on('value', (snapshot) => {
            count = snapshot.val() || 500;
            counterEl.textContent = count;
            updateUI();
        });

        function decreaseCounter() {
            if (count > 0) {
                count--;
                counterRef.set(count);
            }
        }

        function updateUI() {
            if (count === 0) {
                messageEl.textContent = "Все напитки, к сожалению, уже раздали.";
                buttonEl.disabled = true;
            } else {
                messageEl.textContent = "";
                buttonEl.disabled = false;
            }
        }

        function toggleMode() {
            if (!isEditMode) {
                buttonEl.classList.add('hidden');
                counterEl.classList.add('expanded');
                messageEl.classList.add('hidden');
            } else {
                counterEl.classList.remove('expanded');
                counterEl.classList.add('hidden');
                buttonEl.classList.remove('hidden');
                buttonEl.classList.add('full-button');
                messageEl.classList.add('hidden');
            }
            isEditMode = !isEditMode;

            setTimeout(() => {
                document.getElementById('editButton').ondblclick = editCounter;
            }, 100);
        }

        function editCounter() {
            const newCount = prompt("Отредактировать количество напитков:", count);
            if (newCount !== null && !isNaN(newCount) && newCount >= 0) {
                count = parseInt(newCount);
                counterRef.set(count);
            }
        }
    </script>
</body>
</html>
